!function(e){function __webpack_require__(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,__webpack_require__),r.l=!0,r.exports}var t=window.webpackJsonp;window.webpackJsonp=function(n,o,i){for(var s,a,c,u=0,l=[];u<n.length;u++)a=n[u],r[a]&&l.push(r[a][0]),r[a]=0;for(s in o)Object.prototype.hasOwnProperty.call(o,s)&&(e[s]=o[s]);for(t&&t(n,o,i);l.length;)l.shift()();if(i)for(u=0;u<i.length;u++)c=__webpack_require__(__webpack_require__.s=i[u]);return c};var n={},r={2:0};__webpack_require__.m=e,__webpack_require__.c=n,__webpack_require__.d=function(e,t,n){__webpack_require__.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},__webpack_require__.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return __webpack_require__.d(t,"a",t),t},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.p="/",__webpack_require__.oe=function(e){throw console.error(e),e},__webpack_require__(__webpack_require__.s=2)}({"../node_modules/@microsoft/teams-js/dist/MicrosoftTeams.min.js":function(e,t,n){var r,o,i;!function(n,s){o=[],r=s,void 0!==(i="function"==typeof r?r.apply(t,o):r)&&(e.exports=i)}(0,function(){var e;return function(_){"use strict";function e(){if(!N){N=!0,I=this._window||window;var e=function(e){return d(e)};I.addEventListener("message",e,!1),A=I.parent!==I.self?I.parent:I.opener;try{S="*";var t=C(A,"initialize",[x]);B[t]=function(e,t){j=e,O=t}}finally{S=null}this._uninitialize=function(){j===D.settings&&J.registerOnSaveHandler(null),j===D.remove&&J.registerOnRemoveHandler(null),N=!1,A=null,S=null,H=[],U=null,P=null,F=[],W=0,B={},j=null,O=null,I.removeEventListener("message",e,!1)}}}function n(e){h();var t=C(A,"getContext");B[t]=e}function i(e){h(),R=e}function o(e){R&&R(e),U&&C(U,"themeChange",[e])}function a(e){h(),V=e}function r(e){V&&V(e)}function s(e){h(D.content,D.settings,D.remove);var t=C(A,"navigateCrossDomain",[e]);B[t]=function(e){if(!e)throw new Error("Cross-origin navigation is only supported for URLs matching the pattern registered in the manifest.")}}function u(e,t){h();var n=C(A,"getTabInstances",[t]);B[n]=e}function c(e,t){h();var n=C(A,"getMruTabInstances",[t]);B[n]=e}function f(e){h(D.content),C(A,"shareDeepLink",[e.subEntityId,e.subEntityLabel,e.subEntityWebUrl])}function l(e){h();var t=C(A,"navigateToTab",[e]);B[t]=function(e){if(!e)throw new Error("Invalid internalTabInstanceId and/or channelId were/was provided")}}function h(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!N)throw new Error("The library has not yet been initialized");if(j&&e&&e.length>0){for(var n=!1,r=0;r<e.length;r++)if(e[r]===j){n=!0;break}if(!n)throw new Error("This call is not allowed in the '"+j+"' context")}}function d(e){if(e&&e.data&&"object"==typeof e.data){var t=e.source||e.originalEvent.source,n=e.origin||e.originalEvent.origin;t===I||n!==I.location.origin&&-1===q.indexOf(n.toLowerCase())||(g(t,n),t===A?v(e):t===U&&p(e))}}function g(e,t){A&&e!==A?U&&e!==U||(U=e,P=t):(A=e,S=t),A&&A.closed&&(A=null,S=null),U&&U.closed&&(U=null,P=null),b(A),b(U)}function v(e){if("id"in e.data){var t=e.data,n=B[t.id];n&&(n.apply(null,t.args),delete B[t.id])}else if("func"in e.data){var t=e.data,r=L[t.func];r&&r.apply(this,t.args)}}function p(e){if("id"in e.data&&"func"in e.data){var t=e.data,n=L[t.func];if(n){var r=n.apply(this,t.args);r&&k(U,t.id,Array.isArray(r)?r:[r])}else{var o=C(A,t.func,t.args);B[o]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];U&&k(U,t.id,e)}}}}function y(e){return e===A?H:e===U?F:[]}function m(e){return e===A?S:e===U?P:null}function b(e){for(var t=m(e),n=y(e);e&&t&&n.length>0;)e.postMessage(n.shift(),t)}function w(e,t){var n=I.setInterval(function(){0===y(e).length&&(clearInterval(n),t())},100)}function C(e,t,n){var r=T(t,n),o=m(e);return e&&o?e.postMessage(r,o):y(e).push(r),r.id}function k(e,t,n){var r=E(t,n),o=m(e);e&&o&&e.postMessage(r,o)}function T(e,t){return{id:W++,func:e,args:t||[]}}function E(e,t){return{id:e,args:t||[]}}var I,A,S,U,P,j,O,R,x="1.2",q=["https://teams.microsoft.com","https://teams.microsoft.us","https://int.teams.microsoft.com","https://devspaces.skype.com","https://ssauth.skype.com","http://dev.local"],L={},D={settings:"settings",content:"content",authentication:"authentication",remove:"remove"},M={desktop:"desktop",web:"web"},N=!1,H=[],F=[],W=0,B={};L.themeChange=o;var V;L.fullScreenChange=r,_.initialize=e,_.getContext=n,_.registerOnThemeChangeHandler=i,_.registerFullScreenHandler=a,_.navigateCrossDomain=s,_.getTabInstances=u,_.getMruTabInstances=c,_.shareDeepLink=f,_.navigateToTab=l;var J;!function(t){function e(e){h(D.settings,D.remove),C(A,"settings.setValidityState",[e])}function n(e){h(D.settings,D.remove);var t=C(A,"settings.getSettings");B[t]=e}function i(e){h(D.settings),C(A,"settings.setSettings",[e])}function o(e){h(D.settings),c=e}function a(e){h(D.remove),u=e}function r(){var e=new l;c?c(e):e.notifySuccess()}function s(){var e=new d;u?u(e):e.notifySuccess()}var c,u;L["settings.save"]=r,L["settings.remove"]=s,t.setValidityState=e,t.getSettings=n,t.setSettings=i,t.registerOnSaveHandler=o,t.registerOnRemoveHandler=a;var l=function(){function t(){this.notified=!1}return t.prototype.notifySuccess=function(){this.ensureNotNotified(),C(A,"settings.save.success"),this.notified=!0},t.prototype.notifyFailure=function(e){this.ensureNotNotified(),C(A,"settings.save.failure",[e]),this.notified=!0},t.prototype.ensureNotNotified=function(){if(this.notified)throw new Error("The SaveEvent may only notify success or failure once.")},t}(),d=function(){function t(){this.notified=!1}return t.prototype.notifySuccess=function(){this.ensureNotNotified(),C(A,"settings.remove.success"),this.notified=!0},t.prototype.notifyFailure=function(e){this.ensureNotNotified(),C(A,"settings.remove.failure",[e]),this.notified=!0},t.prototype.ensureNotNotified=function(){if(this.notified)throw new Error("The removeEvent may only notify success or failure once.")},t}()}(J=_.settings||(_.settings={}));!function(t){function e(e){if(h(D.content,D.settings,D.remove),O===M.desktop){var t=document.createElement("a");t.href=e.url;var n=C(A,"authentication.authenticate",[t.href,e.width,e.height]);B[n]=function(t,n){t?e.successCallback(n):e.failureCallback(n)}}else a(e)}function n(e){h();var t=C(A,"authentication.getAuthToken",[e.resources]);B[t]=function(t,n){t?e.successCallback(n):e.failureCallback(n)}}function i(e){h();var t=C(A,"authentication.getUser");B[t]=function(t,n){t?e.successCallback(n):e.failureCallback(n)}}function o(){r();try{U&&U.close()}finally{U=null,P=null}}function a(e){d=e,o();var t=d.width||600,n=d.height||400;t=Math.min(t,I.outerWidth-400),n=Math.min(n,I.outerHeight-200);var r=document.createElement("a");r.href=d.url;var i=void 0!==I.screenLeft?I.screenLeft:I.screenX,a=void 0!==I.screenTop?I.screenTop:I.screenY;i+=I.outerWidth/2-t/2,a+=I.outerHeight/2-n/2,U=I.open(r.href,"_blank","toolbar=no, location=yes, status=no, menubar=no, top="+a+", left="+i+", width="+t+", height="+n),U?s():l("FailedToOpenWindow")}function r(){p&&(clearInterval(p),p=0),delete L.initialize,delete L.navigateCrossDomain}function s(){r(),p=I.setInterval(function(){if(!U||U.closed)l("CancelledByUser");else{var e=P;try{P="*",C(U,"ping")}finally{P=e}}},100),L.initialize=function(){return[D.authentication,O]},L.navigateCrossDomain=function(e){return!1}}function u(e){h(D.authentication),C(A,"authentication.authenticate.success",[e]),w(A,function(){return I.close()})}function c(e){h(D.authentication),C(A,"authentication.authenticate.failure",[e]),w(A,function(){return I.close()})}function f(e){try{d&&d.successCallback&&d.successCallback(e)}finally{d=null,o()}}function l(e){try{d&&d.failureCallback&&d.failureCallback(e)}finally{d=null,o()}}var d,p;L["authentication.authenticate.success"]=f,L["authentication.authenticate.failure"]=l,t.authenticate=e,t.getAuthToken=n,t.getUser=i,t.notifySuccess=u,t.notifyFailure=c}(_.authentication||(_.authentication={}))}(e||(e={})),e})},"../node_modules/msal/lib-commonjs/AadAuthority.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("../node_modules/tslib/tslib.es6.js"),o=n("../node_modules/msal/lib-commonjs/Authority.js"),i=n("../node_modules/msal/lib-commonjs/XHRClient.js"),s=function(e){function AadAuthority(t,n){return e.call(this,t,n)||this}return r.__extends(AadAuthority,e),Object.defineProperty(AadAuthority.prototype,"AadInstanceDiscoveryEndpointUrl",{get:function(){return AadAuthority.AadInstanceDiscoveryEndpoint+"?api-version=1.0&authorization_endpoint="+this.CanonicalAuthority+"oauth2/v2.0/authorize"},enumerable:!0,configurable:!0}),Object.defineProperty(AadAuthority.prototype,"AuthorityType",{get:function(){return o.AuthorityType.Aad},enumerable:!0,configurable:!0}),AadAuthority.prototype.GetOpenIdConfigurationEndpointAsync=function(){var e=this,t=new Promise(function(t,n){return t(e.DefaultOpenIdConfigurationEndpoint)});if(!this.IsValidationEnabled)return t;var n=this.CanonicalAuthorityUrlComponents.HostNameAndPort;return this.IsInTrustedHostList(n)?t:(new i.XhrClient).sendRequestAsync(this.AadInstanceDiscoveryEndpointUrl,"GET",!0).then(function(e){return e.tenant_discovery_endpoint})},AadAuthority.prototype.IsInTrustedHostList=function(e){return AadAuthority.TrustedHostList[e.toLowerCase()]},AadAuthority.AadInstanceDiscoveryEndpoint="https://login.microsoftonline.com/common/discovery/instance",AadAuthority.TrustedHostList={"login.windows.net":"login.windows.net","login.chinacloudapi.cn":"login.chinacloudapi.cn","login.cloudgovapi.us":"login.cloudgovapi.us","login.microsoftonline.com":"login.microsoftonline.com","login.microsoftonline.de":"login.microsoftonline.de","login.microsoftonline.us":"login.microsoftonline.us"},AadAuthority}(o.Authority);t.AadAuthority=s},"../node_modules/msal/lib-commonjs/AccessTokenCacheItem.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function AccessTokenCacheItem(e,t){this.key=e,this.value=t}return AccessTokenCacheItem}();t.AccessTokenCacheItem=r},"../node_modules/msal/lib-commonjs/AccessTokenKey.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("../node_modules/msal/lib-commonjs/Utils.js"),o=function(){function AccessTokenKey(e,t,n,o,i){this.authority=e,this.clientId=t,this.scopes=n,this.userIdentifier=r.Utils.base64EncodeStringUrlSafe(o)+"."+r.Utils.base64EncodeStringUrlSafe(i)}return AccessTokenKey}();t.AccessTokenKey=o},"../node_modules/msal/lib-commonjs/AccessTokenValue.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function AccessTokenValue(e,t,n,r){this.accessToken=e,this.idToken=t,this.expiresIn=n,this.clientInfo=r}return AccessTokenValue}();t.AccessTokenValue=r},"../node_modules/msal/lib-commonjs/AuthenticationRequestParameters.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("../node_modules/msal/lib-commonjs/Utils.js"),o=function(){function AuthenticationRequestParameters(e,t,n,o,i){this.authorityInstance=e,this.clientId=t,this.scopes=n,this.responseType=o,this.redirectUri=i,this.correlationId=r.Utils.createNewGuid(),this.state=r.Utils.createNewGuid(),this.nonce=r.Utils.createNewGuid(),this.xClientSku="MSAL.JS",this.xClientVer=r.Utils.getLibraryVersion()}return Object.defineProperty(AuthenticationRequestParameters.prototype,"authority",{get:function(){return this.authorityInstance.CanonicalAuthority},enumerable:!0,configurable:!0}),AuthenticationRequestParameters.prototype.createNavigateUrl=function(e){e||(e=[this.clientId]),-1===e.indexOf(this.clientId)&&e.push(this.clientId);var t=[];t.push("response_type="+this.responseType),this.translateclientIdUsedInScope(e),t.push("scope="+encodeURIComponent(this.parseScope(e))),t.push("client_id="+encodeURIComponent(this.clientId)),t.push("redirect_uri="+encodeURIComponent(this.redirectUri)),t.push("state="+encodeURIComponent(this.state)),t.push("nonce="+encodeURIComponent(this.nonce)),t.push("client_info=1"),t.push("x-client-SKU="+this.xClientSku),t.push("x-client-Ver="+this.xClientVer),this.extraQueryParameters&&t.push(this.extraQueryParameters),t.push("client-request-id="+encodeURIComponent(this.correlationId));var n=this.authorityInstance.AuthorizationEndpoint;return n.indexOf("?")<0?n+="?":n+="&",""+n+t.join("&")},AuthenticationRequestParameters.prototype.translateclientIdUsedInScope=function(e){var t=e.indexOf(this.clientId);t>=0&&(e.splice(t,1),-1===e.indexOf("openid")&&e.push("openid"),-1===e.indexOf("profile")&&e.push("profile"))},AuthenticationRequestParameters.prototype.parseScope=function(e){var t="";if(e)for(var n=0;n<e.length;++n)t+=n!==e.length-1?e[n]+" ":e[n];return t},AuthenticationRequestParameters}();t.AuthenticationRequestParameters=o},"../node_modules/msal/lib-commonjs/Authority.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("../node_modules/msal/lib-commonjs/Utils.js"),o=n("../node_modules/msal/lib-commonjs/ErrorMessage.js"),i=n("../node_modules/msal/lib-commonjs/XHRClient.js");!function(e){e[e.Aad=0]="Aad",e[e.Adfs=1]="Adfs",e[e.B2C=2]="B2C"}(t.AuthorityType||(t.AuthorityType={}));var s=function(){function Authority(e,t){this.IsValidationEnabled=t,this.CanonicalAuthority=e,this.validateAsUri()}return Object.defineProperty(Authority.prototype,"Tenant",{get:function(){return this.CanonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!0,configurable:!0}),Object.defineProperty(Authority.prototype,"AuthorizationEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.AuthorizationEndpoint.replace("{tenant}",this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(Authority.prototype,"EndSessionEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.EndSessionEndpoint.replace("{tenant}",this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(Authority.prototype,"SelfSignedJwtAudience",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.Issuer.replace("{tenant}",this.Tenant)},enumerable:!0,configurable:!0}),Authority.prototype.validateResolved=function(){if(!this.tenantDiscoveryResponse)throw"Please call ResolveEndpointsAsync first"},Object.defineProperty(Authority.prototype,"CanonicalAuthority",{get:function(){return this.canonicalAuthority},set:function(e){this.canonicalAuthority=r.Utils.CanonicalizeUri(e),this.canonicalAuthorityUrlComponents=null},enumerable:!0,configurable:!0}),Object.defineProperty(Authority.prototype,"CanonicalAuthorityUrlComponents",{get:function(){return this.canonicalAuthorityUrlComponents||(this.canonicalAuthorityUrlComponents=r.Utils.GetUrlComponents(this.CanonicalAuthority)),this.canonicalAuthorityUrlComponents},enumerable:!0,configurable:!0}),Object.defineProperty(Authority.prototype,"DefaultOpenIdConfigurationEndpoint",{get:function(){return this.CanonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!0,configurable:!0}),Authority.prototype.validateAsUri=function(){var e;try{e=this.CanonicalAuthorityUrlComponents}catch(e){throw o.ErrorMessage.invalidAuthorityType}if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw o.ErrorMessage.authorityUriInsecure;if(!e.PathSegments||e.PathSegments.length<1)throw o.ErrorMessage.authorityUriInvalidPath},Authority.prototype.DiscoverEndpoints=function(e){return(new i.XhrClient).sendRequestAsync(e,"GET",!0).then(function(e){return{AuthorizationEndpoint:e.authorization_endpoint,EndSessionEndpoint:e.end_session_endpoint,Issuer:e.issuer}})},Authority.prototype.ResolveEndpointsAsync=function(){var e=this,t="";return this.GetOpenIdConfigurationEndpointAsync().then(function(n){return t=n,e.DiscoverEndpoints(t)}).then(function(t){return e.tenantDiscoveryResponse=t,e})},Authority}();t.Authority=s},"../node_modules/msal/lib-commonjs/AuthorityFactory.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("../node_modules/msal/lib-commonjs/Utils.js"),o=n("../node_modules/msal/lib-commonjs/AadAuthority.js"),i=n("../node_modules/msal/lib-commonjs/B2cAuthority.js"),s=n("../node_modules/msal/lib-commonjs/Authority.js"),a=n("../node_modules/msal/lib-commonjs/ErrorMessage.js"),c=function(){function AuthorityFactory(){}return AuthorityFactory.DetectAuthorityFromUrl=function(e){switch(e=r.Utils.CanonicalizeUri(e),r.Utils.GetUrlComponents(e).PathSegments[0]){case"tfp":return s.AuthorityType.B2C;case"adfs":return s.AuthorityType.Adfs;default:return s.AuthorityType.Aad}},AuthorityFactory.CreateInstance=function(e,t){switch(AuthorityFactory.DetectAuthorityFromUrl(e)){case s.AuthorityType.B2C:return new i.B2cAuthority(e,t);case s.AuthorityType.Aad:return new o.AadAuthority(e,t);default:throw a.ErrorMessage.invalidAuthorityType}},AuthorityFactory}();t.AuthorityFactory=c},"../node_modules/msal/lib-commonjs/B2cAuthority.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("../node_modules/tslib/tslib.es6.js"),o=n("../node_modules/msal/lib-commonjs/AadAuthority.js"),i=n("../node_modules/msal/lib-commonjs/Authority.js"),s=n("../node_modules/msal/lib-commonjs/ErrorMessage.js"),a=n("../node_modules/msal/lib-commonjs/Utils.js"),c=function(e){function B2cAuthority(t,n){var r=e.call(this,t,n)||this,o=a.Utils.GetUrlComponents(t),i=o.PathSegments;if(i.length<3)throw s.ErrorMessage.b2cAuthorityUriInvalidPath;return r.CanonicalAuthority="https://"+o.HostNameAndPort+"/"+i[0]+"/"+i[1]+"/"+i[2]+"/",r}return r.__extends(B2cAuthority,e),Object.defineProperty(B2cAuthority.prototype,"AuthorityType",{get:function(){return i.AuthorityType.B2C},enumerable:!0,configurable:!0}),B2cAuthority.prototype.GetOpenIdConfigurationEndpointAsync=function(){var e=this,t=new Promise(function(t,n){return t(e.DefaultOpenIdConfigurationEndpoint)});return this.IsValidationEnabled?this.IsInTrustedHostList(this.CanonicalAuthorityUrlComponents.HostNameAndPort)?t:new Promise(function(e,t){return t(s.ErrorMessage.unsupportedAuthorityValidation)}):t},B2cAuthority}(o.AadAuthority);t.B2cAuthority=c},"../node_modules/msal/lib-commonjs/ClientInfo.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("../node_modules/msal/lib-commonjs/Utils.js"),o=function(){function ClientInfo(e){if(!e||r.Utils.isEmpty(e))return this.uid="",void(this.utid="");try{var t=r.Utils.base64DecodeStringUrlSafe(e),n=JSON.parse(t);n&&(n.hasOwnProperty("uid")&&(this.uid=n.uid),n.hasOwnProperty("utid")&&(this.utid=n.utid))}catch(e){throw new Error(e)}}return Object.defineProperty(ClientInfo.prototype,"uid",{get:function(){return this._uid?this._uid:""},set:function(e){this._uid=e},enumerable:!0,configurable:!0}),Object.defineProperty(ClientInfo.prototype,"utid",{get:function(){return this._utid?this._utid:""},set:function(e){this._utid=e},enumerable:!0,configurable:!0}),ClientInfo}();t.ClientInfo=o},"../node_modules/msal/lib-commonjs/Constants.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function Constants(){}return Object.defineProperty(Constants,"errorDescription",{get:function(){return"error_description"},enumerable:!0,configurable:!0}),Object.defineProperty(Constants,"error",{get:function(){return"error"},enumerable:!0,configurable:!0}),Object.defineProperty(Constants,"scope",{get:function(){return"scope"},enumerable:!0,configurable:!0}),Object.defineProperty(Constants,"acquireTokenUser",{get:function(){return"msal_acquireTokenUser"},enumerable:!0,configurable:!0}),Object.defineProperty(Constants,"clientInfo",{get:function(){return"client_info"},enumerable:!0,configurable:!0}),Object.defineProperty(Constants,"clientId",{get:function(){return"clientId"},enumerable:!0,configurable:!0}),Object.defineProperty(Constants,"authority",{get:function(){return"authority"},enumerable:!0,configurable:!0}),Object.defineProperty(Constants,"idToken",{get:function(){return"id_token"},enumerable:!0,configurable:!0}),Object.defineProperty(Constants,"accessToken",{get:function(){return"access_token"},enumerable:!0,configurable:!0}),Object.defineProperty(Constants,"expiresIn",{get:function(){return"expires_in"},enumerable:!0,configurable:!0}),Object.defineProperty(Constants,"sessionState",{get:function(){return"session_state"},enumerable:!0,configurable:!0}),Object.defineProperty(Constants,"msalClientInfo",{get:function(){return"msal.client.info"},enumerable:!0,configurable:!0}),Object.defineProperty(Constants,"msalError",{get:function(){return"msal.error"},enumerable:!0,configurable:!0}),Object.defineProperty(Constants,"msalErrorDescription",{get:function(){return"msal.error.description"},enumerable:!0,configurable:!0}),Object.defineProperty(Constants,"msalSessionState",{get:function(){return"msal.session.state"},enumerable:!0,configurable:!0}),Object.defineProperty(Constants,"tokenKeys",{get:function(){return"msal.token.keys"},enumerable:!0,configurable:!0}),Object.defineProperty(Constants,"accessTokenKey",{get:function(){return"msal.access.token.key"},enumerable:!0,configurable:!0}),Object.defineProperty(Constants,"expirationKey",{get:function(){return"msal.expiration.key"},enumerable:!0,configurable:!0}),Object.defineProperty(Constants,"stateLogin",{get:function(){return"msal.state.login"},enumerable:!0,configurable:!0}),Object.defineProperty(Constants,"stateAcquireToken",{get:function(){return"msal.state.acquireToken"},enumerable:!0,configurable:!0}),Object.defineProperty(Constants,"stateRenew",{get:function(){return"msal.state.renew"},enumerable:!0,configurable:!0}),Object.defineProperty(Constants,"nonceIdToken",{get:function(){return"msal.nonce.idtoken"},enumerable:!0,configurable:!0}),Object.defineProperty(Constants,"userName",{get:function(){return"msal.username"},enumerable:!0,configurable:!0}),Object.defineProperty(Constants,"idTokenKey",{get:function(){return"msal.idtoken"},enumerable:!0,configurable:!0}),Object.defineProperty(Constants,"loginRequest",{get:function(){return"msal.login.request"},enumerable:!0,configurable:!0}),Object.defineProperty(Constants,"loginError",{get:function(){return"msal.login.error"},enumerable:!0,configurable:!0}),Object.defineProperty(Constants,"renewStatus",{get:function(){return"msal.token.renew.status"},enumerable:!0,configurable:!0}),Object.defineProperty(Constants,"msal",{get:function(){return"msal"},enumerable:!0,configurable:!0}),Object.defineProperty(Constants,"resourceDelimeter",{get:function(){return"|"},enumerable:!0,configurable:!0}),Object.defineProperty(Constants,"tokenRenewStatusCancelled",{get:function(){return"Canceled"},enumerable:!0,configurable:!0}),Object.defineProperty(Constants,"tokenRenewStatusCompleted",{get:function(){return"Completed"},enumerable:!0,configurable:!0}),Object.defineProperty(Constants,"tokenRenewStatusInProgress",{get:function(){return"In Progress"},enumerable:!0,configurable:!0}),Object.defineProperty(Constants,"popUpWidth",{get:function(){return this._popUpWidth},set:function(e){this._popUpWidth=e},enumerable:!0,configurable:!0}),Object.defineProperty(Constants,"popUpHeight",{get:function(){return this._popUpHeight},set:function(e){this._popUpHeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(Constants,"login",{get:function(){return"LOGIN"},enumerable:!0,configurable:!0}),Object.defineProperty(Constants,"renewToken",{get:function(){return"renewToken"},enumerable:!0,configurable:!0}),Object.defineProperty(Constants,"unknown",{get:function(){return"UNKNOWN"},enumerable:!0,configurable:!0}),Object.defineProperty(Constants,"urlHash",{get:function(){return"msal.urlHash"},enumerable:!0,configurable:!0}),Constants._popUpWidth=483,Constants._popUpHeight=600,Constants}();t.Constants=r;var o=function(){function ErrorCodes(){}return Object.defineProperty(ErrorCodes,"loginProgressError",{get:function(){return"login_progress_error"},enumerable:!0,configurable:!0}),Object.defineProperty(ErrorCodes,"acquireTokenProgressError",{get:function(){return"acquiretoken_progress_error"},enumerable:!0,configurable:!0}),Object.defineProperty(ErrorCodes,"inputScopesError",{get:function(){return"input_scopes_error"},enumerable:!0,configurable:!0}),Object.defineProperty(ErrorCodes,"endpointResolutionError",{get:function(){return"endpoints_resolution_error"},enumerable:!0,configurable:!0}),Object.defineProperty(ErrorCodes,"popUpWindowError",{get:function(){return"popup_window_error"},enumerable:!0,configurable:!0}),Object.defineProperty(ErrorCodes,"userLoginError",{get:function(){return"user_login_error"},enumerable:!0,configurable:!0}),Object.defineProperty(ErrorCodes,"userCancelledError",{get:function(){return"user_cancelled"},enumerable:!0,configurable:!0}),ErrorCodes}();t.ErrorCodes=o;var i=function(){function ErrorDescription(){}return Object.defineProperty(ErrorDescription,"loginProgressError",{get:function(){return"Login is in progress"},enumerable:!0,configurable:!0}),Object.defineProperty(ErrorDescription,"acquireTokenProgressError",{get:function(){return"Acquire token is in progress"},enumerable:!0,configurable:!0}),Object.defineProperty(ErrorDescription,"inputScopesError",{get:function(){return"Invalid value of input scopes provided"},enumerable:!0,configurable:!0}),Object.defineProperty(ErrorDescription,"endpointResolutionError",{get:function(){return"Endpoints cannot be resolved"},enumerable:!0,configurable:!0}),Object.defineProperty(ErrorDescription,"popUpWindowError",{get:function(){return"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},enumerable:!0,configurable:!0}),Object.defineProperty(ErrorDescription,"userLoginError",{get:function(){return"User login is required"},enumerable:!0,configurable:!0}),Object.defineProperty(ErrorDescription,"userCancelledError",{get:function(){return"User closed the popup window window and cancelled the flow"},enumerable:!0,configurable:!0}),ErrorDescription}();t.ErrorDescription=i},"../node_modules/msal/lib-commonjs/ErrorMessage.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function ErrorMessage(){}return Object.defineProperty(ErrorMessage,"authorityUriInvalidPath",{get:function(){return"AuthorityUriInvalidPath"},enumerable:!0,configurable:!0}),Object.defineProperty(ErrorMessage,"authorityUriInsecure",{get:function(){return"AuthorityUriInsecure"},enumerable:!0,configurable:!0}),Object.defineProperty(ErrorMessage,"invalidAuthorityType",{get:function(){return"InvalidAuthorityType"},enumerable:!0,configurable:!0}),Object.defineProperty(ErrorMessage,"unsupportedAuthorityValidation",{get:function(){return"UnsupportedAuthorityValidation"},enumerable:!0,configurable:!0}),Object.defineProperty(ErrorMessage,"b2cAuthorityUriInvalidPath",{get:function(){return"B2cAuthorityUriInvalidPath"},enumerable:!0,configurable:!0}),ErrorMessage}();t.ErrorMessage=r},"../node_modules/msal/lib-commonjs/IdToken.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("../node_modules/msal/lib-commonjs/Utils.js"),o=function(){function IdToken(e){if(r.Utils.isEmpty(e))throw new Error("null or empty raw idtoken");try{this.rawIdToken=e,this.decodedIdToken=r.Utils.extractIdToken(e),this.decodedIdToken&&(this.decodedIdToken.hasOwnProperty("iss")&&(this.issuer=this.decodedIdToken.iss),this.decodedIdToken.hasOwnProperty("oid")&&(this.objectId=this.decodedIdToken.oid),this.decodedIdToken.hasOwnProperty("sub")&&(this.subject=this.decodedIdToken.sub),this.decodedIdToken.hasOwnProperty("tid")&&(this.tenantId=this.decodedIdToken.tid),this.decodedIdToken.hasOwnProperty("ver")&&(this.version=this.decodedIdToken.ver),this.decodedIdToken.hasOwnProperty("preferred_username")&&(this.preferredName=this.decodedIdToken.preferred_username),this.decodedIdToken.hasOwnProperty("name")&&(this.name=this.decodedIdToken.name),this.decodedIdToken.hasOwnProperty("nonce")&&(this.nonce=this.decodedIdToken.nonce),this.decodedIdToken.hasOwnProperty("exp")&&(this.expiration=this.decodedIdToken.exp),this.decodedIdToken.hasOwnProperty("home_oid")&&(this.homeObjectId=this.decodedIdToken.home_oid))}catch(e){throw new Error("Failed to parse the returned id token")}}return IdToken}();t.IdToken=o},"../node_modules/msal/lib-commonjs/Logger.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n("../node_modules/msal/lib-commonjs/Utils.js");!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(r=t.LogLevel||(t.LogLevel={}));var i=function(){function Logger(e,t){void 0===t&&(t={}),this._level=r.Info;var n=t.correlationId,o=void 0===n?"":n,i=t.level,s=void 0===i?r.Info:i,a=t.piiLoggingEnabled,c=void 0!==a&&a;this._localCallback=e,this._correlationId=o,this._level=s,this._piiLoggingEnabled=c}return Logger.prototype.logMessage=function(e,t,n){if(!(e>this._level||!this._piiLoggingEnabled&&n)){var i,s=(new Date).toUTCString();i=o.Utils.isEmpty(this._correlationId)?s+":"+o.Utils.getLibraryVersion()+"-"+r[e]+" "+t:s+":"+this._correlationId+"-"+o.Utils.getLibraryVersion()+"-"+r[e]+" "+t,this.executeCallback(e,i,n)}},Logger.prototype.executeCallback=function(e,t,n){this._localCallback&&this._localCallback(e,t,n)},Logger.prototype.error=function(e){this.logMessage(r.Error,e,!1)},Logger.prototype.errorPii=function(e){this.logMessage(r.Error,e,!0)},Logger.prototype.warning=function(e){this.logMessage(r.Warning,e,!1)},Logger.prototype.warningPii=function(e){this.logMessage(r.Warning,e,!0)},Logger.prototype.info=function(e){this.logMessage(r.Info,e,!1)},Logger.prototype.infoPii=function(e){this.logMessage(r.Info,e,!0)},Logger.prototype.verbose=function(e){this.logMessage(r.Verbose,e,!1)},Logger.prototype.verbosePii=function(e){this.logMessage(r.Verbose,e,!0)},Logger}();t.Logger=i},"../node_modules/msal/lib-commonjs/RequestInfo.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function TokenResponse(){this.valid=!1,this.parameters={},this.stateMatch=!1,this.stateResponse="",this.requestType="unknown"}return TokenResponse}();t.TokenResponse=r},"../node_modules/msal/lib-commonjs/Storage.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("../node_modules/msal/lib-commonjs/Constants.js"),o=n("../node_modules/msal/lib-commonjs/AccessTokenCacheItem.js"),i=function(){function Storage(e){if(Storage._instance)return Storage._instance;if(this._cacheLocation=e,this._localStorageSupported=void 0!==window[this._cacheLocation]&&null!=window[this._cacheLocation],this._sessionStorageSupported=void 0!==window[e]&&null!=window[e],Storage._instance=this,!this._localStorageSupported&&!this._sessionStorageSupported)throw new Error("localStorage and sessionStorage not supported");return Storage._instance}return Storage.prototype.setItem=function(e,t){if(!window[this._cacheLocation])throw new Error("localStorage and sessionStorage are not supported");window[this._cacheLocation].setItem(e,t)},Storage.prototype.getItem=function(e){if(window[this._cacheLocation])return window[this._cacheLocation].getItem(e);throw new Error("localStorage and sessionStorage are not supported")},Storage.prototype.removeItem=function(e){if(window[this._cacheLocation])return window[this._cacheLocation].removeItem(e);throw new Error("localStorage and sessionStorage are not supported")},Storage.prototype.clear=function(){if(window[this._cacheLocation])return window[this._cacheLocation].clear();throw new Error("localStorage and sessionStorage are not supported")},Storage.prototype.getAllAccessTokens=function(e,t){var n,r=[],i=window[this._cacheLocation];if(!i)throw new Error("localStorage and sessionStorage are not supported");var s=void 0;for(s in i)if(i.hasOwnProperty(s)&&s.match(e)&&s.match(t)){var a=this.getItem(s);a&&(n=new o.AccessTokenCacheItem(JSON.parse(s),JSON.parse(a)),r.push(n))}return r},Storage.prototype.removeAcquireTokenEntries=function(e,t){var n=window[this._cacheLocation];if(!n)throw new Error("localStorage and sessionStorage are not supported");var r=void 0;for(r in n)n.hasOwnProperty(r)&&(r.indexOf(e)>-1||r.indexOf(t)>-1)&&this.removeItem(r)},Storage.prototype.resetCacheItems=function(){var e=window[this._cacheLocation];if(!e)throw new Error("localStorage and sessionStorage are not supported");var t=void 0;for(t in e)e.hasOwnProperty(t)&&-1!==t.indexOf(r.Constants.msal)&&(e[t]="")},Storage}();t.Storage=i},"../node_modules/msal/lib-commonjs/User.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("../node_modules/msal/lib-commonjs/Utils.js"),o=function(){function User(e,t,n,r,o){this.displayableId=e,this.name=t,this.identityProvider=n,this.userIdentifier=r,this.idToken=o}return User.createUser=function(e,t,n){var o,i;t?(o=t.uid,i=t.utid):(o="",i="");var s=r.Utils.base64EncodeStringUrlSafe(o)+"."+r.Utils.base64EncodeStringUrlSafe(i);return new User(e.preferredName,e.name,e.issuer,s,e.decodedIdToken)},User}();t.User=o},"../node_modules/msal/lib-commonjs/UserAgentApplication.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("../node_modules/tslib/tslib.es6.js"),o=n("../node_modules/msal/lib-commonjs/AccessTokenKey.js"),i=n("../node_modules/msal/lib-commonjs/AccessTokenValue.js"),s=n("../node_modules/msal/lib-commonjs/AuthenticationRequestParameters.js"),a=n("../node_modules/msal/lib-commonjs/ClientInfo.js"),c=n("../node_modules/msal/lib-commonjs/Constants.js"),u=n("../node_modules/msal/lib-commonjs/IdToken.js"),l=n("../node_modules/msal/lib-commonjs/Logger.js"),d=n("../node_modules/msal/lib-commonjs/Storage.js"),p=n("../node_modules/msal/lib-commonjs/RequestInfo.js"),h=n("../node_modules/msal/lib-commonjs/User.js"),f=n("../node_modules/msal/lib-commonjs/Utils.js"),m=n("../node_modules/msal/lib-commonjs/AuthorityFactory.js"),g={id_token:"id_token",token:"token",id_token_token:"id_token token"},y=function(e,t,n){var r=n.value;return n.value=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.isInIframe()?new Promise(function(){}):r.apply(this,e)},n},_=function(){function UserAgentApplication(e,t,n,r){void 0===r&&(r={}),this._cacheLocations={localStorage:"localStorage",sessionStorage:"sessionStorage"},this._clockSkew=300,this._tokenReceivedCallback=null;var o=r.validateAuthority,i=void 0===o||o,s=r.cacheLocation,a=void 0===s?"sessionStorage":s,u=r.redirectUri,p=void 0===u?window.location.href.split("?")[0].split("#")[0]:u,h=r.postLogoutRedirectUri,f=void 0===h?window.location.href.split("?")[0].split("#")[0]:h,m=r.logger,g=void 0===m?new l.Logger(null):m,y=r.loadFrameTimeout,_=void 0===y?6e3:y,v=r.navigateToLoginRequestUrl,b=void 0===v||v;if(this.loadFrameTimeout=_,this.clientId=e,this.validateAuthority=i,this.authority=t||"https://login.microsoftonline.com/common",this._tokenReceivedCallback=n,this._redirectUri=p,this._postLogoutredirectUri=f,this._loginInProgress=!1,this._acquireTokenInProgress=!1,this._renewStates=[],this._activeRenewals={},this._cacheLocation=a,this._navigateToLoginRequestUrl=b,!this._cacheLocations[a])throw new Error("Cache Location is not valid. Provided value:"+this._cacheLocation+".Possible values are: "+this._cacheLocations.localStorage+", "+this._cacheLocations.sessionStorage);this._cacheStorage=new d.Storage(this._cacheLocation),this._logger=g,this._openedWindows=[],window.msal=this,window.callBackMappedToRenewStates={},window.callBacksMappedToRenewStates={};var w=window.location.hash;if(this.isCallback(w))this.handleAuthenticationResponse.call(this,w);else{var C=this._cacheStorage.getItem(c.Constants.urlHash);C&&this.processCallBack(C)}}return Object.defineProperty(UserAgentApplication.prototype,"cacheLocation",{get:function(){return this._cacheLocation},enumerable:!0,configurable:!0}),Object.defineProperty(UserAgentApplication.prototype,"authority",{get:function(){return this.authorityInstance.CanonicalAuthority},set:function(e){this.authorityInstance=m.AuthorityFactory.CreateInstance(e,this.validateAuthority)},enumerable:!0,configurable:!0}),UserAgentApplication.prototype.processCallBack=function(e){this._logger.info("Processing the callback from redirect response");var t=this.getRequestInfo(e);this.saveTokenFromHash(t);var n,r=t.parameters[c.Constants.accessToken]||t.parameters[c.Constants.idToken],o=t.parameters[c.Constants.errorDescription],i=t.parameters[c.Constants.error];n=t.parameters[c.Constants.accessToken]?c.Constants.accessToken:c.Constants.idToken,this._cacheStorage.removeItem(c.Constants.urlHash);try{this._tokenReceivedCallback&&this._tokenReceivedCallback.call(this,o,r,i,n)}catch(e){this._logger.error("Error occurred in token received callback function: "+e)}},UserAgentApplication.prototype.loginRedirect=function(e,t){var n=this;if(this._loginInProgress&&this._tokenReceivedCallback)return void this._tokenReceivedCallback("Login is in progress",null,null,c.Constants.idToken);if(e){var r=this.validateInputScope(e);if(r&&!f.Utils.isEmpty(r)&&this._tokenReceivedCallback)return void this._tokenReceivedCallback(r,null,null,c.Constants.idToken);e=this.filterScopes(e)}this.authorityInstance.ResolveEndpointsAsync().then(function(){var r=new s.AuthenticationRequestParameters(n.authorityInstance,n.clientId,e,g.id_token,n._redirectUri);t&&(r.extraQueryParameters=t),n._cacheStorage.setItem(c.Constants.loginRequest,window.location.href),n._cacheStorage.setItem(c.Constants.loginError,""),n._cacheStorage.setItem(c.Constants.stateLogin,r.state),n._cacheStorage.setItem(c.Constants.nonceIdToken,r.nonce),n._cacheStorage.setItem(c.Constants.msalError,""),n._cacheStorage.setItem(c.Constants.msalErrorDescription,"");var o=c.Constants.authority+c.Constants.resourceDelimeter+r.state;f.Utils.isEmpty(n._cacheStorage.getItem(o))&&n._cacheStorage.setItem(o,n.authority);var i=r.createNavigateUrl(e)+"&prompt=select_account&response_mode=fragment";n._loginInProgress=!0,n._requestType=c.Constants.login,n.promptUser(i)})},UserAgentApplication.prototype.loginPopup=function(e,t){var n=this;return new Promise(function(r,o){if(n._loginInProgress)return void o(c.ErrorCodes.loginProgressError+":"+c.ErrorDescription.loginProgressError);if(e){var i=n.validateInputScope(e);if(i&&!f.Utils.isEmpty(i))return void o(c.ErrorCodes.inputScopesError+":"+c.ErrorDescription.inputScopesError);e=n.filterScopes(e)}else e=[n.clientId];var a=e.join(" ").toLowerCase(),u=n.openWindow("about:blank","_blank",1,n,r,o);u&&n.authorityInstance.ResolveEndpointsAsync().then(function(){var i=new s.AuthenticationRequestParameters(n.authorityInstance,n.clientId,e,g.id_token,n._redirectUri);t&&(i.extraQueryParameters=t),n._cacheStorage.setItem(c.Constants.loginRequest,window.location.href),n._cacheStorage.setItem(c.Constants.loginError,""),n._cacheStorage.setItem(c.Constants.nonceIdToken,i.nonce),n._cacheStorage.setItem(c.Constants.msalError,""),n._cacheStorage.setItem(c.Constants.msalErrorDescription,"");var l=c.Constants.authority+c.Constants.resourceDelimeter+i.state;f.Utils.isEmpty(n._cacheStorage.getItem(l))&&n._cacheStorage.setItem(l,n.authority);var d=i.createNavigateUrl(e)+"&prompt=select_account&response_mode=fragment";n._renewStates.push(i.state),n.registerCallback(i.state,a,r,o),n._requestType=c.Constants.login,n._loginInProgress=!0,u&&(n._logger.infoPii("Navigated Popup window to:"+d),u.location.href=d)},function(){n._logger.info(c.ErrorCodes.endpointResolutionError+":"+c.ErrorDescription.endpointResolutionError),n._cacheStorage.setItem(c.Constants.msalError,c.ErrorCodes.endpointResolutionError),n._cacheStorage.setItem(c.Constants.msalErrorDescription,c.ErrorDescription.endpointResolutionError),o&&o(c.ErrorCodes.endpointResolutionError+":"+c.ErrorDescription.endpointResolutionError),u&&u.close()})})},UserAgentApplication.prototype.promptUser=function(e){e&&!f.Utils.isEmpty(e)?(this._logger.infoPii("Navigate to:"+e),window.location.replace(e)):this._logger.info("Navigate url is empty")},UserAgentApplication.prototype.openWindow=function(e,t,n,r,o,i){var s=this,a=this.openPopup(e,t,c.Constants.popUpWidth,c.Constants.popUpHeight);if(null==a)return r._loginInProgress=!1,r._acquireTokenInProgress=!1,this._logger.info(c.ErrorCodes.popUpWindowError+":"+c.ErrorDescription.popUpWindowError),this._cacheStorage.setItem(c.Constants.msalError,c.ErrorCodes.popUpWindowError),this._cacheStorage.setItem(c.Constants.msalErrorDescription,c.ErrorDescription.popUpWindowError),i&&i(c.ErrorCodes.popUpWindowError+":"+c.ErrorDescription.popUpWindowError),null;this._openedWindows.push(a);var u=window.setInterval(function(){a&&a.closed&&r._loginInProgress&&(r._loginInProgress=!1,r._acquireTokenInProgress=!1,i&&i(c.ErrorCodes.userCancelledError+":"+c.ErrorDescription.userCancelledError),window.clearInterval(u));try{-1!==a.location.href.indexOf(s._redirectUri)&&(window.clearInterval(u),r._loginInProgress=!1,r._acquireTokenInProgress=!1,s._logger.info("Closing popup window"))}catch(e){}},n);return a},UserAgentApplication.prototype.logout=function(){this.clearCache(),this._user=null;var e="";this._postLogoutredirectUri&&(e="post_logout_redirect_uri="+encodeURIComponent(this._postLogoutredirectUri));var t=this.authority+"/oauth2/v2.0/logout?"+e;this.promptUser(t)},UserAgentApplication.prototype.clearCache=function(){this._renewStates=[];for(var e=this._cacheStorage.getAllAccessTokens(c.Constants.clientId,c.Constants.authority),t=0;t<e.length;t++)this._cacheStorage.removeItem(JSON.stringify(e[t].key));this._cacheStorage.removeAcquireTokenEntries(c.Constants.acquireTokenUser,c.Constants.renewStatus),this._cacheStorage.removeAcquireTokenEntries(c.Constants.authority+c.Constants.resourceDelimeter,c.Constants.renewStatus),this._cacheStorage.resetCacheItems()},UserAgentApplication.prototype.openPopup=function(e,t,n,r){try{var o=window.screenLeft?window.screenLeft:window.screenX,i=window.screenTop?window.screenTop:window.screenY,s=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,a=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,c=s/2-n/2+o,u=a/2-r/2+i,l=window.open(e,t,"width="+n+", height="+r+", top="+u+", left="+c);return l.focus&&l.focus(),l}catch(e){return this._logger.error("error opening popup "+e.message),this._loginInProgress=!1,this._acquireTokenInProgress=!1,null}},UserAgentApplication.prototype.validateInputScope=function(e){if(!e||e.length<1)return"Scopes cannot be passed as an empty array";if(!Array.isArray(e))throw new Error("API does not accept non-array scopes");return e.indexOf(this.clientId)>-1&&e.length>1?"ClientId can only be provided as a single scope":""},UserAgentApplication.prototype.filterScopes=function(e){return e=e.filter(function(e){return"openid"!==e}),e=e.filter(function(e){return"profile"!==e})},UserAgentApplication.prototype.registerCallback=function(e,t,n,r){var o=this;this._activeRenewals[t]=e,window.callBacksMappedToRenewStates[e]||(window.callBacksMappedToRenewStates[e]=[]),window.callBacksMappedToRenewStates[e].push({resolve:n,reject:r}),window.callBackMappedToRenewStates[e]||(window.callBackMappedToRenewStates[e]=function(n,r,i,s){o._activeRenewals[t]=null;for(var a=0;a<window.callBacksMappedToRenewStates[e].length;++a)try{n||i?window.callBacksMappedToRenewStates[e][a].reject(n+": "+i):r&&window.callBacksMappedToRenewStates[e][a].resolve(r)}catch(e){o._logger.warning(e)}window.callBacksMappedToRenewStates[e]=null,window.callBackMappedToRenewStates[e]=null})},UserAgentApplication.prototype.getCachedToken=function(e,t){var n=null,r=e.scopes,o=this._cacheStorage.getAllAccessTokens(this.clientId,t.userIdentifier);if(0===o.length)return null;var i=[];if(e.authority){for(var s=0;s<o.length;s++){var a=o[s],c=a.key.scopes.split(" ");f.Utils.containsScope(c,r)&&a.key.authority===e.authority&&i.push(a)}if(0===i.length)return null;if(1!==i.length)return{errorDesc:"The cache contains multiple tokens satisfying the requirements.Call AcquireToken again providing more requirements like authority",token:null,error:"multiple_matching_tokens_detected"};n=i[0]}else{for(var s=0;s<o.length;s++){var a=o[s],c=a.key.scopes.split(" ");f.Utils.containsScope(c,r)&&i.push(a)}if(1===i.length)n=i[0],e.authorityInstance=m.AuthorityFactory.CreateInstance(n.key.authority,this.validateAuthority);else{if(i.length>1)return{errorDesc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements like authority",token:null,error:"multiple_matching_tokens_detected"};var u=this.getUniqueAuthority(o,"authority");if(u.length>1)return{errorDesc:"Multiple authorities found in the cache. Pass authority in the API overload.",token:null,error:"multiple_matching_tokens_detected"};e.authorityInstance=m.AuthorityFactory.CreateInstance(u[0],this.validateAuthority)}}if(null!=n){var l=Number(n.value.expiresIn),d=this._clockSkew||300;return l&&l>f.Utils.now()+d?{errorDesc:null,token:n.value.accessToken,error:null}:(this._cacheStorage.removeItem(JSON.stringify(i[0].key)),null)}return null},UserAgentApplication.prototype.getAllUsers=function(){for(var e=[],t=this._cacheStorage.getAllAccessTokens(c.Constants.clientId,c.Constants.authority),n=0;n<t.length;n++){var r=new u.IdToken(t[n].value.idToken),o=new a.ClientInfo(t[n].value.clientInfo),i=h.User.createUser(r,o,this.authority);e.push(i)}return this.getUniqueUsers(e)},UserAgentApplication.prototype.getUniqueUsers=function(e){if(!e||e.length<=1)return e;for(var t=[],n=[],r=0;r<e.length;++r)e[r].userIdentifier&&-1===t.indexOf(e[r].userIdentifier)&&(t.push(e[r].userIdentifier),n.push(e[r]));return n},UserAgentApplication.prototype.getUniqueAuthority=function(e,t){var n=[],r=[];return e.forEach(function(e){e.key.hasOwnProperty(t)&&-1===r.indexOf(e.key[t])&&(r.push(e.key[t]),n.push(e.key[t]))}),n},UserAgentApplication.prototype.addHintParameters=function(e,t){var n=t||this.getUser(),r=n.userIdentifier.split("."),o=f.Utils.base64DecodeStringUrlSafe(r[0]),i=f.Utils.base64DecodeStringUrlSafe(r[1]);return this.urlContainsQueryStringParameter("login_hint",e)||!n.displayableId||f.Utils.isEmpty(n.displayableId)||(e+="&login_hint="+encodeURIComponent(t.displayableId)),f.Utils.isEmpty(o)||f.Utils.isEmpty(i)||(this.urlContainsQueryStringParameter("domain_req",e)||f.Utils.isEmpty(i)||(e+="&domain_req="+encodeURIComponent(i)),this.urlContainsQueryStringParameter("login_req",e)||f.Utils.isEmpty(o)||(e+="&login_req="+encodeURIComponent(o)),this.urlContainsQueryStringParameter("domain_hint",e)||f.Utils.isEmpty(i)||(e+="9188040d-6c67-4c5b-b112-36a304b66dad"===i?"&domain_hint="+encodeURIComponent("consumers"):"&domain_hint="+encodeURIComponent("organizations"))),e},UserAgentApplication.prototype.urlContainsQueryStringParameter=function(e,t){return new RegExp("[\\?&]"+e+"=").test(t)},UserAgentApplication.prototype.acquireTokenRedirect=function(e,t,n,r){var o=this,i=this.validateInputScope(e);if(i&&!f.Utils.isEmpty(i)&&this._tokenReceivedCallback)return void this._tokenReceivedCallback(i,null,null,c.Constants.accessToken);e&&(e=this.filterScopes(e));var a=n||this.getUser();if(!this._acquireTokenInProgress){e.join(" ").toLowerCase();if(!a&&this._tokenReceivedCallback)return void this._tokenReceivedCallback(c.ErrorDescription.userLoginError,null,c.ErrorCodes.userLoginError,c.Constants.accessToken);this._acquireTokenInProgress=!0;var u,l=t?m.AuthorityFactory.CreateInstance(t,this.validateAuthority):this.authorityInstance;l.ResolveEndpointsAsync().then(function(){u=f.Utils.compareObjects(a,o.getUser())?new s.AuthenticationRequestParameters(l,o.clientId,e,g.token,o._redirectUri):new s.AuthenticationRequestParameters(l,o.clientId,e,g.id_token_token,o._redirectUri),o._cacheStorage.setItem(c.Constants.nonceIdToken,u.nonce);var t=c.Constants.acquireTokenUser+c.Constants.resourceDelimeter+a.userIdentifier+c.Constants.resourceDelimeter+u.state;f.Utils.isEmpty(o._cacheStorage.getItem(t))&&o._cacheStorage.setItem(t,JSON.stringify(a));var n=c.Constants.authority+c.Constants.resourceDelimeter+u.state;f.Utils.isEmpty(o._cacheStorage.getItem(n))&&o._cacheStorage.setItem(n,l.CanonicalAuthority),r&&(u.extraQueryParameters=r);var i=u.createNavigateUrl(e)+"&prompt=select_account&response_mode=fragment";(i=o.addHintParameters(i,a))&&(o._cacheStorage.setItem(c.Constants.stateAcquireToken,u.state),o._requestType=c.Constants.renewToken,window.location.replace(i))})}},UserAgentApplication.prototype.acquireTokenPopup=function(e,t,n,r){var o=this;return new Promise(function(i,a){var u=o.validateInputScope(e);u&&!f.Utils.isEmpty(u)&&a(c.ErrorCodes.inputScopesError+":"+u),e&&(e=o.filterScopes(e));var l=n||o.getUser();if(o._acquireTokenInProgress)return void a(c.ErrorCodes.acquireTokenProgressError+":"+c.ErrorDescription.acquireTokenProgressError);var d=e.join(" ").toLowerCase();if(!l)return void a(c.ErrorCodes.userLoginError+":"+c.ErrorDescription.userLoginError);o._acquireTokenInProgress=!0;var p,h=t?m.AuthorityFactory.CreateInstance(t,o.validateAuthority):o.authorityInstance,y=o.openWindow("about:blank","_blank",1,o,i,a);y&&h.ResolveEndpointsAsync().then(function(){p=f.Utils.compareObjects(l,o.getUser())?e.indexOf(o.clientId)>-1?new s.AuthenticationRequestParameters(h,o.clientId,e,g.id_token,o._redirectUri):new s.AuthenticationRequestParameters(h,o.clientId,e,g.token,o._redirectUri):new s.AuthenticationRequestParameters(h,o.clientId,e,g.id_token_token,o._redirectUri),o._cacheStorage.setItem(c.Constants.nonceIdToken,p.nonce),p.state=p.state;var t=c.Constants.acquireTokenUser+c.Constants.resourceDelimeter+l.userIdentifier+c.Constants.resourceDelimeter+p.state;f.Utils.isEmpty(o._cacheStorage.getItem(t))&&o._cacheStorage.setItem(t,JSON.stringify(l));var n=c.Constants.authority+c.Constants.resourceDelimeter+p.state;f.Utils.isEmpty(o._cacheStorage.getItem(n))&&o._cacheStorage.setItem(n,h.CanonicalAuthority),r&&(p.extraQueryParameters=r);var u=p.createNavigateUrl(e)+"&prompt=select_account&response_mode=fragment";u=o.addHintParameters(u,l),o._renewStates.push(p.state),o.registerCallback(p.state,d,i,a),o._requestType=c.Constants.renewToken,y&&(y.location.href=u)},function(){o._logger.info(c.ErrorCodes.endpointResolutionError+":"+c.ErrorDescription.endpointResolutionError),o._cacheStorage.setItem(c.Constants.msalError,c.ErrorCodes.endpointResolutionError),o._cacheStorage.setItem(c.Constants.msalErrorDescription,c.ErrorDescription.endpointResolutionError),a&&a(c.ErrorCodes.endpointResolutionError+":"+c.ErrorDescription.endpointResolutionError),y&&y.close()})})},UserAgentApplication.prototype.acquireTokenSilent=function(e,t,n,r){var o=this;return new Promise(function(i,a){var u=o.validateInputScope(e);if(!u||f.Utils.isEmpty(u)){e&&(e=o.filterScopes(e));var l=e.join(" ").toLowerCase(),d=n||o.getUser();if(!d)return void a(c.ErrorCodes.userLoginError+":"+c.ErrorDescription.userLoginError);var p,h=t?m.AuthorityFactory.CreateInstance(t,o.validateAuthority):o.authorityInstance;p=f.Utils.compareObjects(d,o.getUser())?e.indexOf(o.clientId)>-1?new s.AuthenticationRequestParameters(h,o.clientId,e,g.id_token,o._redirectUri):new s.AuthenticationRequestParameters(h,o.clientId,e,g.token,o._redirectUri):new s.AuthenticationRequestParameters(h,o.clientId,e,g.id_token_token,o._redirectUri);var y=o.getCachedToken(p,d);if(y){if(y.token)return o._logger.info("Token is already in cache for scope:"+l),void i(y.token);if(y.errorDesc||y.error)return o._logger.infoPii(y.errorDesc+":"+y.error),void a(y.errorDesc+": "+y.error)}return o._requestType=c.Constants.renewToken,o.authorityInstance.ResolveEndpointsAsync().then(function(){o._activeRenewals[l]?(o._logger.verbose("Renew token for scope: "+l+" is in progress. Registering callback"),o.registerCallback(o._activeRenewals[l],l,i,a)):e&&e.indexOf(o.clientId)>-1&&1===e.length?(o._logger.verbose("renewing idToken"),o.renewIdToken(e,i,a,d,p,r)):(o._logger.verbose("renewing accesstoken"),o.renewToken(e,i,a,d,p,r))})}a(c.ErrorCodes.inputScopesError+":"+u)})},UserAgentApplication.prototype.loadIframeTimeout=function(e,t,n){var r=this;this._logger.verbose("Set loading state to pending for: "+n),this._cacheStorage.setItem(c.Constants.renewStatus+n,c.Constants.tokenRenewStatusInProgress),this.loadFrame(e,t),setTimeout(function(){if(r._cacheStorage.getItem(c.Constants.renewStatus+n)===c.Constants.tokenRenewStatusInProgress){r._logger.verbose("Loading frame has timed out after: "+r.loadFrameTimeout/1e3+" seconds for scope "+n);var e=r._activeRenewals[n];e&&window.callBackMappedToRenewStates[e]&&window.callBackMappedToRenewStates[e]("Token renewal operation failed due to timeout",null,"Token Renewal Failed",c.Constants.accessToken),r._cacheStorage.setItem(c.Constants.renewStatus+n,c.Constants.tokenRenewStatusCancelled)}},this.loadFrameTimeout)},UserAgentApplication.prototype.loadFrame=function(e,t){var n=this;this._logger.info("LoadFrame: "+t);var r=t;setTimeout(function(){var o=n.addAdalFrame(r);""!==o.src&&"about:blank"!==o.src||(o.src=e,n._logger.infoPii("Frame Name : "+t+" Navigated to: "+e))},500)},UserAgentApplication.prototype.addAdalFrame=function(e){if(void 0===e)return null;this._logger.info("Add msal frame to document:"+e);var t=document.getElementById(e);if(!t){if(document.createElement&&document.documentElement&&-1===window.navigator.userAgent.indexOf("MSIE 5.0")){var n=document.createElement("iframe");n.setAttribute("id",e),n.style.visibility="hidden",n.style.position="absolute",n.style.width=n.style.height="0",n.style.border="0",t=document.getElementsByTagName("body")[0].appendChild(n)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeend",'<iframe name="'+e+'" id="'+e+'" style="display:none"></iframe>');window.frames&&window.frames[e]&&(t=window.frames[e])}return t},UserAgentApplication.prototype.renewToken=function(e,t,n,r,o,i){var s=e.join(" ").toLowerCase();this._logger.verbose("renewToken is called for scope:"+s);var a=this.addAdalFrame("msalRenewFrame"+s);i&&(o.extraQueryParameters=i);var u=c.Constants.acquireTokenUser+c.Constants.resourceDelimeter+r.userIdentifier+c.Constants.resourceDelimeter+o.state;f.Utils.isEmpty(this._cacheStorage.getItem(u))&&this._cacheStorage.setItem(u,JSON.stringify(r));var l=c.Constants.authority+c.Constants.resourceDelimeter+o.state;f.Utils.isEmpty(this._cacheStorage.getItem(l))&&this._cacheStorage.setItem(l,o.authority),this._cacheStorage.setItem(c.Constants.nonceIdToken,o.nonce),this._logger.verbose("Renew token Expected state: "+o.state);var d=o.createNavigateUrl(e)+"&prompt=none";d=this.addHintParameters(d,r),this._renewStates.push(o.state),this.registerCallback(o.state,s,t,n),this._logger.infoPii("Navigate to:"+d),a.src="about:blank",this.loadIframeTimeout(d,"msalRenewFrame"+s,s)},UserAgentApplication.prototype.renewIdToken=function(e,t,n,r,o,i){e.join(" ").toLowerCase();this._logger.info("renewidToken is called");var s=this.addAdalFrame("msalIdTokenFrame");i&&(o.extraQueryParameters=i);var a=c.Constants.acquireTokenUser+c.Constants.resourceDelimeter+r.userIdentifier+c.Constants.resourceDelimeter+o.state;f.Utils.isEmpty(this._cacheStorage.getItem(a))&&this._cacheStorage.setItem(a,JSON.stringify(r));var u=c.Constants.authority+c.Constants.resourceDelimeter+o.state;f.Utils.isEmpty(this._cacheStorage.getItem(u))&&this._cacheStorage.setItem(u,o.authority),this._cacheStorage.setItem(c.Constants.nonceIdToken,o.nonce),this._logger.verbose("Renew Idtoken Expected state: "+o.state);var l=o.createNavigateUrl(e)+"&prompt=none";l=this.addHintParameters(l,r),this._renewStates.push(o.state),this.registerCallback(o.state,this.clientId,t,n),this._logger.infoPii("Navigate to:"+l),s.src="about:blank",this.loadIframeTimeout(l,"msalIdTokenFrame",this.clientId)},UserAgentApplication.prototype.getUser=function(){if(this._user)return this._user;var e=this._cacheStorage.getItem(c.Constants.idTokenKey),t=this._cacheStorage.getItem(c.Constants.msalClientInfo);if(!f.Utils.isEmpty(e)&&!f.Utils.isEmpty(t)){var n=new u.IdToken(e),r=new a.ClientInfo(t);return this._user=h.User.createUser(n,r,this.authority),this._user}return null},UserAgentApplication.prototype.handleAuthenticationResponse=function(e){null==e&&(e=window.location.hash);var t=null,n=!1,r=!1;try{r=window.opener&&window.opener.msal&&window.opener.msal!==window.msal}catch(e){r=!1}r?(t=window.opener.msal,n=!0):window.parent&&window.parent.msal&&(t=window.parent.msal);var o,i=t.getRequestInfo(e),s=null,a=null;if(t._logger.info("Returned from redirect url"),window.parent!==window&&window.parent.callBackMappedToRenewStates[i.stateResponse])a=window.parent.callBackMappedToRenewStates[i.stateResponse];else if(window.opener&&window.opener.msal&&window.opener.callBackMappedToRenewStates[i.stateResponse])a=window.opener.callBackMappedToRenewStates[i.stateResponse];else{if(t._navigateToLoginRequestUrl)return a=null,t._cacheStorage.setItem(c.Constants.urlHash,e),!1,void(window.parent!==window||n||(window.location.href=t._cacheStorage.getItem(c.Constants.loginRequest)));a=t._tokenReceivedCallback,window.location.hash=""}t.saveTokenFromHash(i),i.requestType===c.Constants.renewToken&&window.parent?(window.parent!==window?t._logger.verbose("Window is in iframe, acquiring token silently"):t._logger.verbose("acquiring token interactive in progress"),s=i.parameters[c.Constants.accessToken]||i.parameters[c.Constants.idToken],o=c.Constants.accessToken):i.requestType===c.Constants.login&&(s=i.parameters[c.Constants.idToken],o=c.Constants.idToken);var u=i.parameters[c.Constants.errorDescription],l=i.parameters[c.Constants.error];try{a&&a.call(t,u,s,l,o)}catch(e){t._logger.error("Error occurred in token received callback function: "+e)}for(var d=0;d<t._openedWindows.length;d++)t._openedWindows[d].close()},UserAgentApplication.prototype.saveAccessToken=function(e,t,n,r,s){var u,l=new a.ClientInfo(r);if(t.parameters.hasOwnProperty("scope")){u=t.parameters.scope;for(var d=u.split(" "),p=this._cacheStorage.getAllAccessTokens(this.clientId,e),h=0;h<p.length;h++){var m=p[h];if(m.key.userIdentifier===n.userIdentifier){var g=m.key.scopes.split(" ");f.Utils.isIntersectingScopes(g,d)&&this._cacheStorage.removeItem(JSON.stringify(m.key))}}var y=new o.AccessTokenKey(e,this.clientId,u,l.uid,l.utid),_=new i.AccessTokenValue(t.parameters[c.Constants.accessToken],s.rawIdToken,f.Utils.expiresIn(t.parameters[c.Constants.expiresIn]).toString(),r);this._cacheStorage.setItem(JSON.stringify(y),JSON.stringify(_))}else{u=this.clientId;var y=new o.AccessTokenKey(e,this.clientId,u,l.uid,l.utid),_=new i.AccessTokenValue(t.parameters[c.Constants.idToken],t.parameters[c.Constants.idToken],s.expiration,r);this._cacheStorage.setItem(JSON.stringify(y),JSON.stringify(_))}},UserAgentApplication.prototype.saveTokenFromHash=function(e){this._logger.info("State status:"+e.stateMatch+"; Request type:"+e.requestType),this._cacheStorage.setItem(c.Constants.msalError,""),this._cacheStorage.setItem(c.Constants.msalErrorDescription,"");var t="";if(t=e.parameters.hasOwnProperty("scope")?e.parameters.scope:this.clientId,e.parameters.hasOwnProperty(c.Constants.errorDescription)||e.parameters.hasOwnProperty(c.Constants.error))this._logger.infoPii("Error :"+e.parameters[c.Constants.error]+"; Error description:"+e.parameters[c.Constants.errorDescription]),this._cacheStorage.setItem(c.Constants.msalError,e.parameters.error),this._cacheStorage.setItem(c.Constants.msalErrorDescription,e.parameters[c.Constants.errorDescription]),e.requestType===c.Constants.login&&(this._loginInProgress=!1,this._cacheStorage.setItem(c.Constants.loginError,e.parameters[c.Constants.errorDescription]+":"+e.parameters[c.Constants.error])),e.requestType===c.Constants.renewToken&&(this._acquireTokenInProgress=!1);else if(e.stateMatch){this._logger.info("State is right"),e.parameters.hasOwnProperty(c.Constants.sessionState)&&this._cacheStorage.setItem(c.Constants.msalSessionState,e.parameters[c.Constants.sessionState]);var n,r="";if(e.parameters.hasOwnProperty(c.Constants.accessToken)){this._logger.info("Fragment has access token"),this._acquireTokenInProgress=!1;var o=void 0;n=e.parameters.hasOwnProperty(c.Constants.idToken)?new u.IdToken(e.parameters[c.Constants.idToken]):new u.IdToken(this._cacheStorage.getItem(c.Constants.idTokenKey));var i=c.Constants.authority+c.Constants.resourceDelimeter+e.stateResponse,s=void 0;f.Utils.isEmpty(this._cacheStorage.getItem(i))||(s=this._cacheStorage.getItem(i),s=f.Utils.replaceFirstPath(s,n.tenantId)),e.parameters.hasOwnProperty(c.Constants.clientInfo)?(r=e.parameters[c.Constants.clientInfo],o=h.User.createUser(n,new a.ClientInfo(r),s)):(this._logger.warning("ClientInfo not received in the response from AAD"),o=h.User.createUser(n,new a.ClientInfo(r),s));var l=c.Constants.acquireTokenUser+c.Constants.resourceDelimeter+o.userIdentifier+c.Constants.resourceDelimeter+e.stateResponse,d=void 0;f.Utils.isEmpty(this._cacheStorage.getItem(l))||(d=JSON.parse(this._cacheStorage.getItem(l)),o&&d&&f.Utils.compareObjects(o,d)?(this.saveAccessToken(s,e,o,r,n),this._logger.info("The user object received in the response is the same as the one passed in the acquireToken request")):this._logger.warning("The user object created from the response is not the same as the one passed in the acquireToken request"))}if(e.parameters.hasOwnProperty(c.Constants.idToken)&&t.indexOf(this.clientId)>-1){this._logger.info("Fragment has id token"),this._loginInProgress=!1,n=new u.IdToken(e.parameters[c.Constants.idToken]),e.parameters.hasOwnProperty(c.Constants.clientInfo)?r=e.parameters[c.Constants.clientInfo]:this._logger.warning("ClientInfo not received in the response from AAD");var i=c.Constants.authority+c.Constants.resourceDelimeter+e.stateResponse,s=void 0;f.Utils.isEmpty(this._cacheStorage.getItem(i))||(s=this._cacheStorage.getItem(i),s=f.Utils.replaceFirstPath(s,n.tenantId)),this._user=h.User.createUser(n,new a.ClientInfo(r),s),n&&n.nonce?n.nonce!==this._cacheStorage.getItem(c.Constants.nonceIdToken)?(this._user=null,this._cacheStorage.setItem(c.Constants.loginError,"Nonce Mismatch. Expected Nonce: "+this._cacheStorage.getItem(c.Constants.nonceIdToken)+",Actual Nonce: "+n.nonce),this._logger.error("Nonce Mismatch.Expected Nonce: "+this._cacheStorage.getItem(c.Constants.nonceIdToken)+",Actual Nonce: "+n.nonce)):(this._cacheStorage.setItem(c.Constants.idTokenKey,e.parameters[c.Constants.idToken]),this._cacheStorage.setItem(c.Constants.msalClientInfo,r),this.saveAccessToken(s,e,this._user,r,n)):(this._logger.error("Invalid id_token received in the response"),this._cacheStorage.setItem(c.Constants.msalError,"invalid idToken"),this._cacheStorage.setItem(c.Constants.msalErrorDescription,"Invalid idToken. idToken: "+e.parameters[c.Constants.idToken]))}}else this._logger.error("State Mismatch.Expected State: "+this._cacheStorage.getItem(c.Constants.stateLogin)+",Actual State: "+e.stateResponse),this._cacheStorage.setItem(c.Constants.msalError,"Invalid_state"),this._cacheStorage.setItem(c.Constants.msalErrorDescription,"Invalid_state. state: "+e.stateResponse);this._cacheStorage.setItem(c.Constants.renewStatus+t,c.Constants.tokenRenewStatusCompleted),this._cacheStorage.removeAcquireTokenEntries(c.Constants.acquireTokenUser,c.Constants.renewStatus),this._cacheStorage.removeAcquireTokenEntries(c.Constants.authority+c.Constants.resourceDelimeter,c.Constants.renewStatus)},UserAgentApplication.prototype.isCallback=function(e){e=this.getHash(e);var t=f.Utils.deserialize(e);return t.hasOwnProperty(c.Constants.errorDescription)||t.hasOwnProperty(c.Constants.error)||t.hasOwnProperty(c.Constants.accessToken)||t.hasOwnProperty(c.Constants.idToken)},UserAgentApplication.prototype.getHash=function(e){return e.indexOf("#/")>-1?e=e.substring(e.indexOf("#/")+2):e.indexOf("#")>-1&&(e=e.substring(1)),e},UserAgentApplication.prototype.getRequestInfo=function(e){e=this.getHash(e);var t=f.Utils.deserialize(e),n=new p.TokenResponse;if(t&&(n.parameters=t,t.hasOwnProperty(c.Constants.errorDescription)||t.hasOwnProperty(c.Constants.error)||t.hasOwnProperty(c.Constants.accessToken)||t.hasOwnProperty(c.Constants.idToken))){n.valid=!0;var r=void 0;if(!t.hasOwnProperty("state"))return n;if(r=t.state,n.stateResponse=r,r===this._cacheStorage.getItem(c.Constants.stateLogin))return n.requestType=c.Constants.login,n.stateMatch=!0,n;if(r===this._cacheStorage.getItem(c.Constants.stateAcquireToken))return n.requestType=c.Constants.renewToken,n.stateMatch=!0,n;if(!n.stateMatch){window.parent&&window.parent!==window?n.requestType=c.Constants.renewToken:n.requestType=this._requestType;for(var o=this._renewStates,i=0;i<o.length;i++)if(o[i]===n.stateResponse){n.stateMatch=!0;break}}}return n},UserAgentApplication.prototype.getScopeFromState=function(e){if(e){var t=e.indexOf("|");if(t>-1&&t+1<e.length)return e.substring(t+1)}return""},UserAgentApplication.prototype.isInIframe=function(){return window.parent!==window},r.__decorate([y],UserAgentApplication.prototype,"acquireTokenSilent",null),UserAgentApplication}();t.UserAgentApplication=_},"../node_modules/msal/lib-commonjs/Utils.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function Utils(){}return Utils.compareObjects=function(e,t){return!(!e||!t)&&!(!e.userIdentifier||!t.userIdentifier||e.userIdentifier!==t.userIdentifier)},Utils.expiresIn=function(e){return e||(e="3599"),this.now()+parseInt(e,10)},Utils.now=function(){return Math.round((new Date).getTime()/1e3)},Utils.isEmpty=function(e){return void 0===e||!e||0===e.length},Utils.extractIdToken=function(e){var t=this.decodeJwt(e);if(!t)return null;try{var n=t.JWSPayload,r=this.base64DecodeStringUrlSafe(n);return r?JSON.parse(r):null}catch(e){}return null},Utils.base64EncodeStringUrlSafe=function(e){return window.btoa?window.btoa(e):this.encode(e)},Utils.base64DecodeStringUrlSafe=function(e){return e=e.replace(/-/g,"+").replace(/_/g,"/"),window.atob?decodeURIComponent(window.atob(e)):decodeURIComponent(this.decode(e))},Utils.encode=function(e){var t,n,r,o,i,s,a,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u="",l=0;for(e=this.utf8Encode(e);l<e.length;)t=e.charCodeAt(l++),n=e.charCodeAt(l++),r=e.charCodeAt(l++),o=t>>2,i=(3&t)<<4|n>>4,s=(15&n)<<2|r>>6,a=63&r,isNaN(n)?s=a=64:isNaN(r)&&(a=64),u=u+c.charAt(o)+c.charAt(i)+c.charAt(s)+c.charAt(a);return u.replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")},Utils.utf8Encode=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(63&r|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(63&r|128))}return t},Utils.decode=function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";e=String(e).replace(/=+$/,"");var n=e.length;if(n%4==1)throw new Error("The token to be decoded is not correctly encoded.");for(var r,o,i,s,a,c,u,l,d="",p=0;p<n;p+=4){if(r=t.indexOf(e.charAt(p)),o=t.indexOf(e.charAt(p+1)),i=t.indexOf(e.charAt(p+2)),s=t.indexOf(e.charAt(p+3)),p+2===n-1){a=r<<18|o<<12|i<<6,c=a>>16&255,u=a>>8&255,d+=String.fromCharCode(c,u);break}if(p+1===n-1){a=r<<18|o<<12,c=a>>16&255,d+=String.fromCharCode(c);break}a=r<<18|o<<12|i<<6|s,c=a>>16&255,u=a>>8&255,l=255&a,d+=String.fromCharCode(c,u,l)}return d},Utils.decodeJwt=function(e){if(this.isEmpty(e))return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/,n=t.exec(e);return!n||n.length<4?null:{header:n[1],JWSPayload:n[2],JWSSig:n[3]}},Utils.deserialize=function(e){var t,n=/\+/g,r=/([^&=]+)=([^&]*)/g,o=function(e){return decodeURIComponent(e.replace(n," "))},i={};for(t=r.exec(e);t;)i[o(t[1])]=o(t[2]),t=r.exec(e);return i},Utils.isIntersectingScopes=function(e,t){e=this.convertToLowerCase(e);for(var n=0;n<t.length;n++)if(e.indexOf(t[n].toLowerCase())>-1)return!0;return!1},Utils.containsScope=function(e,t){return e=this.convertToLowerCase(e),t.every(function(t){return e.indexOf(t.toString().toLowerCase())>=0})},Utils.convertToLowerCase=function(e){return e.map(function(e){return e.toLowerCase()})},Utils.removeElement=function(e,t){return e.filter(function(e){return e!==t})},Utils.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},Utils.getLibraryVersion=function(){return"0.1.5"},Utils.replaceFirstPath=function(e,t){if(e.match(/^(https?\:)\/\/(([^:\/?#] *)(?:\:([0-9]+))?)([\/]{0,1}[^?#] *)(\?[^#] *|)(#. *|)$/)){var n=Utils.GetUrlComponents(e),r=n.PathSegments;r.shift(),(r[0]&&"common"===r[0]||"organizations"===r[0])&&(r[0]=t,e=n.Protocol+"//"+n.HostNameAndPort+"/"+r.join("/"))}return e},Utils.createNewGuid=function(){var e=window.crypto;if(e&&e.getRandomValues){var t=new Uint8Array(16);return e.getRandomValues(t),t[6]|=64,t[6]&=79,t[8]|=128,t[8]&=191,Utils.decimalToHex(t[0])+Utils.decimalToHex(t[1])+Utils.decimalToHex(t[2])+Utils.decimalToHex(t[3])+"-"+Utils.decimalToHex(t[4])+Utils.decimalToHex(t[5])+"-"+Utils.decimalToHex(t[6])+Utils.decimalToHex(t[7])+"-"+Utils.decimalToHex(t[8])+Utils.decimalToHex(t[9])+"-"+Utils.decimalToHex(t[10])+Utils.decimalToHex(t[11])+Utils.decimalToHex(t[12])+Utils.decimalToHex(t[13])+Utils.decimalToHex(t[14])+Utils.decimalToHex(t[15])}for(var n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",r="0123456789abcdef",o=0,i="",s=0;s<36;s++)"-"!==n[s]&&"4"!==n[s]&&(o=16*Math.random()|0),"x"===n[s]?i+=r[o]:"y"===n[s]?(o&=3,o|=8,i+=r[o]):i+=n[s];return i},Utils.GetUrlComponents=function(e){if(!e)throw"Url required";var t=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),n=e.match(t);if(!n||n.length<6)throw"Valid url required";var r={Protocol:n[1],HostNameAndPort:n[4],AbsolutePath:n[5]},o=r.AbsolutePath.split("/");return o=o.filter(function(e){return e&&e.length>0}),r.PathSegments=o,r},Utils.CanonicalizeUri=function(e){return e&&(e=e.toLowerCase()),e&&!Utils.endsWith(e,"/")&&(e+="/"),e},Utils.endsWith=function(e,t){return!(!e||!t)&&-1!==e.indexOf(t,e.length-t.length)},Utils}();t.Utils=r},"../node_modules/msal/lib-commonjs/XHRClient.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function XhrClient(){}return XhrClient.prototype.sendRequestAsync=function(e,t,n){var r=this;return new Promise(function(n,o){var i=new XMLHttpRequest;if(i.open(t,e,!0),i.onload=function(e){(i.status<200||i.status>=300)&&o(r.handleError(i.responseText));try{var t=JSON.parse(i.responseText)}catch(e){o(r.handleError(i.responseText))}n(t)},i.onerror=function(e){o(i.status)},"GET"!==t)throw"not implemented";i.send()})},XhrClient.prototype.handleError=function(e){var t;try{if(t=JSON.parse(e),t.error)return t.error;throw e}catch(t){return e}},XhrClient}();t.XhrClient=r},"../node_modules/msal/lib-commonjs/index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("../node_modules/msal/lib-commonjs/UserAgentApplication.js");t.UserAgentApplication=r.UserAgentApplication;var o=n("../node_modules/msal/lib-commonjs/Logger.js");t.Logger=o.Logger;var i=n("../node_modules/msal/lib-commonjs/Logger.js");t.LogLevel=i.LogLevel;var s=n("../node_modules/msal/lib-commonjs/User.js");t.User=s.User},"../node_modules/node-libs-browser/node_modules/process/browser.js":function(e,t){function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(e){if(n===setTimeout)return setTimeout(e,0);if((n===defaultSetTimout||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}function runClearTimeout(e){if(r===clearTimeout)return clearTimeout(e);if((r===defaultClearTimeout||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{return r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}function cleanUpNextTick(){a&&i&&(a=!1,i.length?s=i.concat(s):c=-1,s.length&&drainQueue())}function drainQueue(){if(!a){var e=runTimeout(cleanUpNextTick);a=!0;for(var t=s.length;t;){for(i=s,s=[];++c<t;)i&&i[c].run();c=-1,t=s.length}i=null,a=!1,runClearTimeout(e)}}function Item(e,t){this.fun=e,this.array=t}function noop(){}var n,r,o=e.exports={};!function(){try{n="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){n=defaultSetTimout}try{r="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){r=defaultClearTimeout}}();var i,s=[],a=!1,c=-1;o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];s.push(new Item(e,t)),1!==s.length||a||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=noop,o.addListener=noop,o.once=noop,o.off=noop,o.removeListener=noop,o.removeAllListeners=noop,o.emit=noop,o.prependListener=noop,o.prependOnceListener=noop,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},"../node_modules/tslib/tslib.es6.js":function(e,t,n){"use strict";function __extends(e,t){function __(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}function __rest(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&(n[r[o]]=e[r[o]]);return n}function __decorate(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s}function __param(e,t){return function(n,r){t(n,r,e)}}function __metadata(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function __awaiter(e,t,n,r){return new(n||(n=Promise))(function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())})}function __generator(e,t){function verb(e){return function(t){return step([e,t])}}function step(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=r[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(o=s.trys,!(o=o.length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i}function __exportStar(e,t){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}function __values(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}function __read(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s}function __spread(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(__read(arguments[t]));return e}function __await(e){return this instanceof __await?(this.v=e,this):new __await(e)}function __asyncGenerator(e,t,n){function verb(e){o[e]&&(r[e]=function(t){return new Promise(function(n,r){i.push([e,t,n,r])>1||resume(e,t)})})}function resume(e,t){try{step(o[e](t))}catch(e){settle(i[0][3],e)}}function step(e){e.value instanceof __await?Promise.resolve(e.value.v).then(fulfill,reject):settle(i[0][2],e)}function fulfill(e){resume("next",e)}function reject(e){resume("throw",e)}function settle(e,t){e(t),i.shift(),i.length&&resume(i[0][0],i[0][1])}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,o=n.apply(e,t||[]),i=[];return r={},verb("next"),verb("throw"),verb("return"),r[Symbol.asyncIterator]=function(){return this},r}function __asyncDelegator(e){function verb(r,o){e[r]&&(t[r]=function(t){return(n=!n)?{value:__await(e[r](t)),done:"return"===r}:o?o(t):t})}var t,n;return t={},verb("next"),verb("throw",function(e){throw e}),verb("return"),t[Symbol.iterator]=function(){return this},t}function __asyncValues(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator];return t?t.call(e):"function"==typeof __values?__values(e):e[Symbol.iterator]()}function __makeTemplateObject(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function __importStar(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function __importDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.__extends=__extends,n.d(t,"__assign",function(){return o}),t.__rest=__rest,t.__decorate=__decorate,t.__param=__param,t.__metadata=__metadata,t.__awaiter=__awaiter,t.__generator=__generator,t.__exportStar=__exportStar,t.__values=__values,t.__read=__read,t.__spread=__spread,t.__await=__await,t.__asyncGenerator=__asyncGenerator,t.__asyncDelegator=__asyncDelegator,t.__asyncValues=__asyncValues,t.__makeTemplateObject=__makeTemplateObject,t.__importStar=__importStar,t.__importDefault=__importDefault;var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e}},"./auth.tsx":function(e,t,n){"use strict";(function(r){Object.defineProperty(t,"__esModule",{value:!0});var o=n("../node_modules/msal/lib-commonjs/index.js"),i=n("../node_modules/@microsoft/teams-js/dist/MicrosoftTeams.min.js"),s=function(){function Auth(){}return Auth.prototype.signIn=function(){i.initialize();var e=["offline_access","profile","User.ReadBasic.All","mail.send"],t=function(e,t,n,r){},n=new o.UserAgentApplication("530d427b-f6b7-4cb1-a452-1d4c360108f2",null,t,{});n.loginPopup(e).then(function(t){console.log("aquire token",t),n.acquireTokenSilent(e).then(function(e){console.log("final",e),i.authentication.notifySuccess(e)}).catch(function(e){i.authentication.notifyFailure(e)})})},Auth}();t.Auth=s,function(){if("production"!==r.env.NODE_ENV){if("undefined"==typeof __REACT_HOT_LOADER__)return;var t="undefined"!=typeof __webpack_exports__?__webpack_exports__:e.exports;if("function"==typeof t)return void __REACT_HOT_LOADER__.register(t,"module.exports","D:\\Work\\MS\\ProposalManagement\\UI\\src\\auth.tsx");for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var o=void 0;try{o=t[n]}catch(e){continue}__REACT_HOT_LOADER__.register(o,n,"D:\\Work\\MS\\ProposalManagement\\UI\\src\\auth.tsx")}}}()}).call(t,n("../node_modules/node-libs-browser/node_modules/process/browser.js"))},2:function(e,t,n){e.exports=n("./auth.tsx")}});
//# sourceMappingURL=auth.js.map